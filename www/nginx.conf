ssl_certificate /etc/nginx/conf.d/server.crt;
ssl_certificate_key /etc/nginx/conf.d/server.key;
ssl_protocols  SSLv2 SSLv3 TLSv1;
ssl_ciphers  ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;
ssl_prefer_server_ciphers   on;

## Start www.buildblast.com ##
server {
    listen         80;
    server_name    www.buildblast.com;
    rewrite        ^ https://$server_name$request_uri? permanent;
}

server {
    listen       443;
    server_name  www.buildblast.com;
    ssl on;

    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header Host $http_host;
    proxy_redirect off;

    location / {
        proxy_pass  http://localhost:3000/;
    }
}
## End www.buildblast.com ##

## Start play.buildblast.com ##
server {
    listen         80;
    server_name    play.buildblast.com;
    rewrite        ^ https://$server_name$request_uri? permanent; 
}
server {
    listen       443;
    server_name  play.buildblast.com;
    ssl on;

    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header Host $http_host;
    proxy_redirect off;

    location / {
        proxy_pass  http://localhost:8080/;
    }

    location /sockets/ {
        proxy_pass http://localhost:8080/sockets/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_read_timeout 3600; # 1 hour
    }
}
## End play.buildblast.com ##

## Start server0.buildblast.com ##
server {
    listen       80;
    server_name  server0.buildblast.com;

    location / {
        proxy_pass  http://localhost:8081/;
    }

    location /sockets/ {
        proxy_pass http://localhost:8081/sockets/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
    }
}
## End server0.buildblast.com ##

## Start server1.buildblast.com ##
server {
    listen       80;
    server_name  server1.buildblast.com;

    location / {
        proxy_pass  http://localhost:8082/;
    }

    location /sockets/ {
        proxy_pass http://localhost:8082/sockets/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
    }
}
## End server1.buildblast.com ##

## Start server2.buildblast.com ##
server {
    listen       80;
    server_name  server2.buildblast.com;

    location / {
        proxy_pass  http://localhost:8083/;
    }

    location /sockets/ {
        proxy_pass http://localhost:8083/sockets/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
    }
}
## End server2.buildblast.com ##

## Start server3.buildblast.com ##
server {
    listen       80;
    server_name  server3.buildblast.com;

    location / {
        proxy_pass  http://localhost:8084/;
    }

    location /sockets/ {
        proxy_pass http://localhost:8084/sockets/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
    }
}
## End server3.buildblast.com ##

## Start server4.buildblast.com ##
server {
    listen       80;
    server_name  server4.buildblast.com;

    location / {
        proxy_pass  http://localhost:8085/;
    }

    location /sockets/ {
        proxy_pass http://localhost:8085/sockets/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
    }
}
## End server4.buildblast.com ##

## Start server5.buildblast.com ##
server {
    listen       80;
    server_name  server5.buildblast.com;

    location / {
        proxy_pass  http://localhost:8086/;
    }

    location /sockets/ {
        proxy_pass http://localhost:8086/sockets/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
    }
}
## End server5.buildblast.com ##

## Start server6.buildblast.com ##
server {
    listen       80;
    server_name  server6.buildblast.com;

    location / {
        proxy_pass  http://localhost:8087/;
    }

    location /sockets/ {
        proxy_pass http://localhost:8087/sockets/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
    }
}
## End server6.buildblast.com ##

## Start server7.buildblast.com ##
server {
    listen       80;
    server_name  server7.buildblast.com;

    location / {
        proxy_pass  http://localhost:8088/;
    }

    location /sockets/ {
        proxy_pass http://localhost:8088/sockets/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
    }
}
## End server7.buildblast.com ##

## Start server8.buildblast.com ##
server {
    listen       80;
    server_name  server8.buildblast.com;

    location / {
        proxy_pass  http://localhost:8089/;
    }

    location /sockets/ {
        proxy_pass http://localhost:8089/sockets/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
    }
}
## End server8.buildblast.com ##

## Start server9.buildblast.com ##
server {
    listen       80;
    server_name  server9.buildblast.com;

    location / {
        proxy_pass  http://localhost:8090/;
    }

    location /sockets/ {
        proxy_pass http://localhost:8090/sockets/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
    }
}
## End server9.buildblast.com ##
